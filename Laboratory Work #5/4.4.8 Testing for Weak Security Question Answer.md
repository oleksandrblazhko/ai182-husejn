# Тестування на слабку відповідь на питання безпеки

|ID          |
|------------|
|WSTG-ATHN-08|

# Резюме

Часто звані «секретними» питаннями та відповідями, секретні запитання та відповіді часто використовуються для відновлення забутих паролів (див. [Тестування слабких функцій зміни або скидання пароля](https://github.com/oleksandrblazhko/ai182-husejn/blob/Laboratory-Work-%235/Laboratory%20Work%20%235/4.4.9%20Testing%20for%20Weak%20Password%20Change%20or%20Reset%20Functionalities.md), або як додатковий захист на додаток до пароля.

Зазвичай вони генеруються під час створення облікового запису та вимагають від користувача вибрати з кількох попередньо згенерованих запитань і надати відповідну відповідь. Вони можуть дозволити користувачеві створювати власні пари запитань і відповідей. Обидва методи схильні до небезпеки. В ідеалі питання безпеки мають генерувати відповіді, які відомі лише користувачу, і не можуть бути здогадані чи виявлені будь-ким іншим. Це важче, ніж здається. Запитання безпеки та відповіді залежать від секретності відповіді. Питання та відповіді слід вибирати так, щоб відповіді були відомі лише власнику рахунку. Однак, незважаючи на те, що багато відповідей можуть бути невідомими, більшість запитань, які реалізують веб-сайти, рекламують псевдоприватні відповіді.

### Попередньо створені запитання

Більшість попередньо згенерованих запитань досить спрощені за своєю природою і можуть призвести до невпевнених відповідей. Наприклад:

- Відповіді можуть бути відомі членам родини або близьким друзям користувача, напр. «Яке дівоче прізвище твоєї матері?», «Яка твоя дата народження?»
- Відповіді можуть бути легко вгаданими, напр. «Який твій улюблений колір?», «Яка твоя улюблена бейсбольна команда?»
- Відповіді можуть бути грубими, напр. "Яке ім'я вашого улюбленого вчителя середньої школи?" - відповідь, ймовірно, міститься в деяких списках популярних імен, які можна легко завантажити, і тому можна створити сценарій простої атаки грубою силою.
- Відповіді можуть бути загальнодоступними, напр. "Який твій улюблений фільм?" - відповідь легко знайти на сторінці профілю користувача в соціальних мережах.

### Самогенеровані запитання

Проблема з тим, щоб користувачі створювали власні запитання, полягає в тому, що це дозволяє їм генерувати дуже небезпечні запитання або навіть обходити весь сенс наявності таємного запитання. Ось кілька реальних прикладів, які ілюструють цю тезу:

- "Що таке 1+1?"
- "Яке ваше ім'я користувача?"
- "Мій пароль S3curIty!"

# Цілі тесту

- Визначте складність і прості питання.
- Оцініть можливі відповіді користувача та можливості грубої сили.

# Як тестувати

### Тестування на наявність слабких попередньо згенерованих запитань

Спробуйте отримати список секретних запитань, створивши новий обліковий запис або виконавши процедуру «Я не пам’ятаю свій пароль». Спробуйте створити якомога більше питань, щоб отримати гарне уявлення про тип запитань безпеки, які задаються. Якщо будь-яке із запитань безпеки належить до категорій, описаних вище, воно є вразливим до атак (вгадані, підібрані, доступні в соціальних мережах тощо).

### Тестування на слабкі самогенеровані запитання

Спробуйте створити таємні запитання, створивши новий обліковий запис або налаштувавши властивості відновлення пароля наявного облікового запису. Якщо система дозволяє користувачеві генерувати власні контрольні запитання, вона вразлива до створення небезпечних питань. Якщо система використовує самостійно згенеровані питання безпеки під час функції забутого пароля та якщо імена користувачів можна перерахувати, то тестувальнику має бути легко перерахувати кілька самостійно згенерованих запитань. Слід очікувати, що за допомогою цього методу буде знайдено кілька слабких самогенерованих запитань.

### Тестування відповідей грубим методом

Перше, що потрібно взяти до уваги, коли ви намагаєтеся використати питання безпеки, це кількість питань, на які потрібно відповісти. Для більшості програм користувачеві потрібна лише відповідь на одне запитання, тоді як деякі важливі програми можуть вимагати від користувача відповіді на два або навіть більше запитань.

Наступним кроком є оцінка надійності питань безпеки. Чи можна отримати відповіді за допомогою простого пошуку в Google або за допомогою атаки соціальної інженерії? Як тестувальник проникнення, ось покрокова інструкція щодо використання схеми контрольного запитання:

- Чи дозволяє програма кінцевому користувачеві вибрати питання, на яке потрібно відповісти? Якщо так, зосередьтеся на питаннях, які мають:

     - «Публічна» відповідь; наприклад, те, що можна знайти за допомогою простого запиту в пошуковій системі.
     - Фактична відповідь, наприклад "перша школа" або інші факти, які можна знайти.
     – Кілька варіантів відповідей, наприклад, «яка модель була вашою першою машиною». Ці запитання нададуть зловмиснику короткий список можливих відповідей, і на основі статистики зловмисник зможе ранжувати відповіді від найбільш до найменш вірогідних.

- Визначте, скільки у вас відгадок, якщо це можливо.
     - Чи допускає необмежену кількість спроб скидання пароля?
     - Чи є період блокування після X неправильних відповідей? Пам’ятайте, що система блокування сама по собі може бути проблемою безпеки, оскільки нею може скористатися зловмисник, щоб запустити відмову в обслуговуванні проти законних користувачів.
     - Виберіть відповідне запитання на основі аналізу наведених вище пунктів і проведіть дослідження, щоб визначити найбільш ймовірні відповіді.

Ключ до успішного використання та обходу слабкої схеми контрольних запитань полягає в тому, щоб знайти запитання або набір запитань, які дають можливість легко знайти відповіді. Завжди шукайте запитання, які можуть дати вам найбільшу статистичну ймовірність вгадати правильну відповідь, якщо ви абсолютно не впевнені щодо будь-якої відповіді. Зрештою, схема таємного запитання настільки сильна, як і найслабше запитання.

## Посилання

- [Прокляття таємного питання](https://www.schneier.com/essay-081.html)
- [Шпаргалка з питаннями безпеки OWASP](https://cheatsheetseries.owasp.org/cheatsheets/Choosing_and_Using_Security_Questions_Cheat_Sheet.html)
